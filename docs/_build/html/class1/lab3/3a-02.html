<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>1.4.3.2. Simulating a Christmas Tree Packet Attack</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="1.4.3.2. Simulating a Christmas Tree Packet Attack"/>
  <meta name="product" content="F5 Firewall Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-01-28 09:36:45"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Firewall Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.4.3.2. Simulating a Christmas Tree Packet Attack &#8212; F5 Firewall Solutions  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4.3.3. Simulating a TCP SYN DDoS Attack" href="3a-03.html" />
    <link rel="prev" title="1.4.3.1. Configure Logging" href="3a-01.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Firewall Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">1. Class 1: AFM – The Data Center Firewall</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">2. Advanced Multi-Layer Firewall Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">3. Class - F5 BIG-IP DDoS and DNS DoS Protections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">4. Flowmon Integrated Out-of-path DDoS Solution</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">1.4.3.2. Simulating a Christmas Tree Packet Attack</a></li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Firewall Solutions</a>
              &gt; <a href="../class1.html">1. Class 1: AFM – The Data Center Firewall</a>
              &gt; <a href="intro.html">1.4. Lab 3 - AFM DDoS Lab</a>
              &gt; <a href="step3.html">1.4.3. Advanced Firewall Manager (AFM) Detecting and Preventing System DoS and DDoS Attacks</a>

          <span class="right">
             <a href="../../_sources/class1/lab3/3a-02.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-firewall">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="simulating-a-christmas-tree-packet-attack">
<h1>1.4.3.2. Simulating a Christmas Tree Packet Attack<a class="headerlink" href="#simulating-a-christmas-tree-packet-attack" title="Permalink to this headline">¶</a></h1>
<p>Joanna was feeling festive this morning. In this example, we’ll set the
BIG-IP to detect and mitigate Joanna’s attack where all flags on a TCP
packet are set. This is commonly referred to as a Christmas Tree Packet
and is intended to increase processing on in-path network devices and
end hosts to the target.</p>
<p>We’ll use the hping utility to send 25,000 packets to our server, with
random source IPs to simulate a DDoS attack where multiple hosts are
attacking our server. We’ll set the SYN, ACK, FIN, RST, URG, PUSH, Xmas
and Ymas TCP flags.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Bad-Header-TCP</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on the <strong>Bad TCP Flags (All Flags Set)</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ul>
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: Specify 50</p>
</li>
<li><p class="first">Detection Threshold Percent: Specify 200</p>
</li>
<li><div class="first line-block">
<div class="line">Mitigation Threshold EPS: Specify 100</div>
<div class="line"><a class="reference internal" href="../../_images/image78.png"><img alt="image80" src="../../_images/image78.png" style="width: 2.43392in; height: 2.49669in;" /></a></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: tail -f /var/log/ltm</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following command on the BASH prompt:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">hping3</span> <span class="pre">10.20.0.10</span> <span class="pre">--flood</span> <span class="pre">--rand-source</span> <span class="pre">--destport</span> <span class="pre">80</span> <span class="pre">-c</span> <span class="pre">25000</span> <span class="pre">--syn</span> <span class="pre">--ack</span> <span class="pre">--fin</span> <span class="pre">--rst</span> <span class="pre">--push</span> <span class="pre">--urg</span> <span class="pre">--xmas</span> <span class="pre">--ymas</span></code></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">You’ll see the BIG-IP ltm log show that the attack has been
detected:</div>
<div class="line"><a class="reference internal" href="../../_images/image79.png"><img alt="image81" src="../../_images/image79.png" style="width: 4.48611in; height: 0.38889in;" /></a></div>
</div>
</li>
<li><div class="first line-block">
<div class="line">After approximately 60 seconds, press <strong>CTRL+C</strong> to stop the
attack.</div>
<div class="line"><a class="reference internal" href="../../_images/image80.png"><img alt="image82" src="../../_images/image80.png" style="width: 4.43056in; height: 0.97222in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>&gt; <strong>DoS Overview (you
may need to refresh or set the auto refresh to 10 seconds).</strong> You’ll
notice from here you can see all the details of the active attacks.
You can also modify an attack vector right from this screen by
clicking on the attack vector and modifying the details in the fly
out panel.</p>
<p><a class="reference internal" href="../../_images/image81.png"><img alt="image83" src="../../_images/image81.png" style="width: 6.49097in; height: 1.10208in;" /></a></p>
</li>
<li><div class="first line-block">
<div class="line">Return to the BIG-IP web UI. Navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log
entries showing the details surrounding the attack detection and
mitigation.</div>
<div class="line"><a class="reference internal" href="../../_images/image82.png"><img alt="image84" src="../../_images/image82.png" style="width: 5in; height: 1.70833in;" /></a></div>
</div>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Analysis</strong>.
Single-click on the attack ID in the filter list to the right of the
charts and observe the various statistics around the attack.</p>
</li>
</ol>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="3a-01.html" title="1.4.3.1. Configure Logging" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="3a-03.html" title="1.4.3.3. Simulating a TCP SYN DDoS Attack" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>