<!DOCTYPE html>
<head>
  
  <!-- Google Tag Manager -->
  <script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src='https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);})(window,document,'script','dataLayer','GTM-PPZPQ6');</script>
  <!-- End Google Tag Manager -->
    <title>1.4.3.5. Single Endpoint Sweep</title>
  

  <meta charset="utf-8">
  <!-- Twitter Bootstrap viewport setting -->
  <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
  <!-- F5 metadata -->
  <meta name="title" content="1.4.3.5. Single Endpoint Sweep"/>
  <meta name="product" content="F5 Firewall Solutions"/>
  <meta name="version" content=""/>
  <meta name="updated_date"  content="2020-01-28 09:36:45"/>
  <meta name="archived" content="Archived documents excluded"/>
  <meta name="doc_type" content="Manual"/>
  <meta name="lifecycle" content="release"/>
  <meta name="F5 Firewall Solutions" content=""/>


  

  
  <link href="https://cdn.f5.com/favicon.ico" rel="icon">

</head>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>1.4.3.5. Single Endpoint Sweep &#8212; F5 Firewall Solutions  documentation</title>
    <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../../_static/graphviz.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5_agility_theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/bootstrap.min.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/f5-theme.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/CoveoFullSearch.css" />
    <link rel="stylesheet" type="text/css" href="../../_static/css/custom.css" />
    <link rel="stylesheet" type="text/css" href="https://use.fontawesome.com/21fb8a09c3.css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../_static/language_data.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="1.4.3.6. Single Endpoint Flood" href="3a-06.html" />
    <link rel="prev" title="1.4.3.4. Preventing Global DoS Sweep and Flood Attacks" href="3a-04.html" /> 
  </head><body>
  <div id="clouddocs-header"></div>

    <div id="sidebar" class="section-nav">
      
      <!--  version selector ------------------>
      <div id="version_selector_wrapper">
      </div>
      <nav class="nav-sidebartoc">

        
         <h5>F5 Firewall Solutions  </h5>
        

        <hr>
        <span class="nav-sidebartoc">
            <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="../class1.html">1. Class 1: AFM – The Data Center Firewall</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class2/class2.html">2. Advanced Multi-Layer Firewall Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class3/class3.html">3. Class - F5 BIG-IP DDoS and DNS DoS Protections</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../class4/class4.html">4. Flowmon Integrated Out-of-path DDoS Solution</a></li>
</ul>

        </span><!-- Use this file to add extra links to the bottom of the ToC sidebar -->
<hr>
  <span class="nav-sidebartoc">
 <!-- insert content here -->
  </span>
      </nav>
    </div>


    <div id="right-sidebar">
      <h7 style="font-weight:normal">On this page:</h7>
      <nav class="nav-sidebartoc">
        <span class="nav-sidebartoc">
            <ul>
<li><a class="reference internal" href="#">1.4.3.5. Single Endpoint Sweep</a></li>
</ul>

         </span>
      </nav>
    </div>





  
  <div class="main active" id="content" >
    <article class="docs-container site-article-inner">
              <!-- custom breadcrumb -->
        <h5>
            <a href="../../index.html">F5 Firewall Solutions</a>
              &gt; <a href="../class1.html">1. Class 1: AFM – The Data Center Firewall</a>
              &gt; <a href="intro.html">1.4. Lab 3 - AFM DDoS Lab</a>
              &gt; <a href="step3.html">1.4.3. Advanced Firewall Manager (AFM) Detecting and Preventing System DoS and DDoS Attacks</a>

          <span class="right">
             <a href="../../_sources/class1/lab3/3a-05.rst.txt" rel="nofollow">Source</a> |
             <a href="https://github.com/f5devcentral/f5-agility-labs-firewall">Edit on <i class="fa fa-github" aria-hidden="true"></i></a>
          </span>
        </h5>
        <!-- end custom breadcrumb -->
      


    <!--a title="Export PDF" id="export-pdf" class="btn btn btn-link pull-right">View PDF</a-->
    <button type="button" id="export-pdf" class="btn btn-link right">PDF</button>


    
     
         <div class="sidebar" id="version-warning" style="display: none;">
           <p class="first sidebar-title">
           <span class="icon fa fa-info-circle fa-lg"></span> Version notice:</p>
           <p class="last" id="currentVersion"></p>
          </div>


     <div role="main">
        
  <div class="section" id="single-endpoint-sweep">
<h1>1.4.3.5. Single Endpoint Sweep<a class="headerlink" href="#single-endpoint-sweep" title="Permalink to this headline">¶</a></h1>
<p>The single endpoint sweep is an attempt for an attacker to send traffic
across a range of ports on the target server, typically to scan for open
ports.</p>
<ol class="arabic">
<li><p class="first">In the BIG-IP web UI, navigate to <strong>Security</strong> &gt; <strong>DoS Protection</strong>
&gt; <strong>Device Configuration</strong> &gt; <strong>Network Security</strong>.</p>
</li>
<li><p class="first">Expand the <strong>Single-Endpoint</strong> category in the vectors list.</p>
</li>
<li><p class="first">Click on <strong>Single Endpoint Sweep</strong> vector name.</p>
</li>
<li><p class="first">Configure the vector with the following parameters:</p>
<ul>
<li><p class="first">State: Mitigate</p>
</li>
<li><p class="first">Threshold Mode: Fully Manual</p>
</li>
<li><p class="first">Detection Threshold EPS: 150</p>
</li>
<li><p class="first">Mitigation Threshold EPS: 200</p>
</li>
<li><p class="first">Add Source Address to Category: Checked</p>
</li>
<li><p class="first">Category Name: denial_of_service</p>
</li>
<li><p class="first">Sustained Attack Detection Time: 10 seconds</p>
</li>
<li><p class="first">Category Duration Time: 60 seconds</p>
</li>
<li><div class="first line-block">
<div class="line">Packet Type: Move All IPv4 to Selected</div>
<div class="line"><a class="reference internal" href="../../_images/image84.png"><img alt="image86" src="../../_images/image84.png" style="width: 2.7954in; height: 6.25166in;" /></a></div>
</div>
</li>
</ul>
</li>
<li><p class="first">Click <strong>Update</strong> to save your changes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Network Firewall</strong> &gt; <strong>IP
Intelligence</strong> &gt; <strong>Policies</strong>.</p>
</li>
<li><div class="first line-block">
<div class="line">In the <strong>Global Policy</strong> section, change the <strong>IP Intelligence
Policy</strong> to <strong>ip-intelligence</strong>.</div>
<div class="line"><a class="reference internal" href="../../_images/image85.png"><img alt="image87" src="../../_images/image85.png" style="width: 2.56954in; height: 0.91286in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong>.</p>
</li>
<li><p class="first">Click on the <strong>ip-intelligence</strong> policy in the policy list below.</p>
</li>
<li><p class="first">Create a new Blacklist Matching Policy in the IP Intelligence Policy
Properties section with the following attributes, leaving
unspecified attributes with their default values:</p>
<ul class="simple">
<li>Blacklist Category: denial-of-service</li>
<li>Action: drop</li>
<li>Log Blacklist Category Matches: Yes</li>
</ul>
</li>
<li><div class="first line-block">
<div class="line">Click <strong>Add</strong> to add the new Blacklist Matching Policy.</div>
<div class="line"><a class="reference internal" href="../../_images/image86.png"><img alt="image88" src="../../_images/image86.png" style="width: 6.49097in; height: 3.32431in;" /></a></div>
</div>
</li>
<li><p class="first">Click <strong>Update</strong> to save changes to the ip-intelligence policy.</p>
</li>
<li><p class="first">Open the BIG-IP SSH session and scroll the ltm log in real time with
the following command: <code class="docutils literal notranslate"><span class="pre">tail</span> <span class="pre">-f</span> <span class="pre">/var/log/ltm</span></code></p>
</li>
<li><p class="first">On the victim server, start a packet capture with an SSH filter by
issuing sudo tcpdump -nn not port 22</p>
</li>
<li><div class="first line-block">
<div class="line">On the attack host, launch the attack by issuing the following
command on the BASH prompt:</div>
<div class="line"><code class="docutils literal notranslate"><span class="pre">sudo</span> <span class="pre">hping3</span> <span class="pre">10.20.0.10</span> <span class="pre">--flood</span> <span class="pre">--scan</span> <span class="pre">1-65535</span> <span class="pre">-d</span> <span class="pre">128</span> <span class="pre">-w</span> <span class="pre">64</span> <span class="pre">--syn</span></code></div>
</div>
</li>
<li><p class="first">You will see the scan find a few open ports on the server, and the
server will show the inbound sweep traffic. However, you will notice
that the traffic to the server stops after a short time (10 seconds,
the configured sustained attack detection time.) Leave the test
running.</p>
</li>
<li><p class="first">After approximately 60 seconds, sweep traffic will return to the
host. This is because the IP Intelligence categorization of the
attack host has expired. After 10 seconds of traffic, the bad actor
is again blacklisted for another 60 seconds.</p>
</li>
<li><p class="first">Stop the sweep attack on the attack host by pressing <strong>CTRL + C</strong>.</p>
</li>
<li><p class="first">Return to the BIG-IP web UI and navigate to <strong>Security</strong> &gt; <strong>Event
Logs</strong> &gt; <strong>DoS</strong> &gt; <strong>Network</strong> &gt; <strong>Events</strong>. Observe the log entries
showing the details surrounding the attack detection and mitigation.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the log entries showing the mitigation of
the sweep attack via the ip-intelligence policy.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Event Logs</strong> &gt; <strong>Network</strong> &gt; <strong>Shun</strong>.
Observe the log entries showing the blacklist adds and deletes.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>Network</strong> &gt; <strong>IP
Intelligence</strong>. Observe the statistics showing the sweep attack and
mitigation. Change the <strong>View By</strong> drop-down to view the varying
statistics.</p>
</li>
<li><p class="first">Navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt; <strong>Dashboard</strong>
to view an overview of the DoS attacks and timeline. You can select
filters in the filter pane to highlight the specific attack.</p>
</li>
<li><p class="first">Finally, navigate to <strong>Security</strong> &gt; <strong>Reporting</strong> &gt; <strong>DoS</strong> &gt;
<strong>Analysis</strong>. View detailed statistics around the attack.</p>
</li>
</ol>
</div>


     </div>
    
     <div class="row next-prev-btn-row">
       <div class="col-lg-12">
       
        <a href="3a-04.html" title="1.4.3.4. Preventing Global DoS Sweep and Flood Attacks" accesskey="p" class="btn btn-primary left"><i class="fa fa-arrow-circle-left" aria-hidden="true"></i> Previous</a>
       
       
          <a href="3a-06.html" title="1.4.3.6. Single Endpoint Flood" accesskey="n" class="btn btn-primary right">Next <i class="fa fa-arrow-circle-right" aria-hidden="true"></i></a>
       
     </div>
     </div>
    

    </article>
  </div>

</div>


  <div id="clouddocs-footer"></div>
  <!-- Bootstrap core JavaScript
  ================================================== -->
  <!-- Placed at the end of the document so the pages load faster -->

  <script src="../../_static/js/index.js"></script>
  <script src="../../_static/js/jquery.appear.js"></script>
  <script src="../../_static/js/printThis.js"></script>
  <script src="../../_static/js/bootstrap.min.js"></script>
  <script src="../../_static/js/clouddocs.js"></script>
  <script src="../../_static/js/CoveoJsSearch.Lazy.min.js"></script>
  </body>
</html>